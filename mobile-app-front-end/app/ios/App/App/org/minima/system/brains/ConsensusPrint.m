//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./org/minima/system/brains/ConsensusPrint.java
//

#include "J2ObjC_source.h"
#include "java/lang/Double.h"
#include "java/lang/Integer.h"
#include "java/lang/Long.h"
#include "java/lang/System.h"
#include "java/math/BigInteger.h"
#include "java/util/ArrayList.h"
#include "java/util/Enumeration.h"
#include "java/util/Hashtable.h"
#include "org/minima/GlobalParams.h"
#include "org/minima/database/MinimaDB.h"
#include "org/minima/database/coindb/CoinDB.h"
#include "org/minima/database/coindb/CoinDBPrinter.h"
#include "org/minima/database/coindb/CoinDBRow.h"
#include "org/minima/database/mmr/MMRPrint.h"
#include "org/minima/database/mmr/MMRProof.h"
#include "org/minima/database/mmr/MMRSet.h"
#include "org/minima/database/txpowdb/TxPowDB.h"
#include "org/minima/database/txpowdb/TxPowDBPrinter.h"
#include "org/minima/database/txpowtree/BlockTree.h"
#include "org/minima/database/txpowtree/BlockTreeNode.h"
#include "org/minima/database/txpowtree/BlockTreePrinter.h"
#include "org/minima/database/userdb/UserDB.h"
#include "org/minima/database/userdb/java/reltxpow.h"
#include "org/minima/objects/Address.h"
#include "org/minima/objects/Coin.h"
#include "org/minima/objects/PubPrivKey.h"
#include "org/minima/objects/TokenDetails.h"
#include "org/minima/objects/TxPOW.h"
#include "org/minima/objects/base/MiniHash.h"
#include "org/minima/objects/base/MiniNumber.h"
#include "org/minima/objects/base/MiniString.h"
#include "org/minima/system/Main.h"
#include "org/minima/system/backup/BackupManager.h"
#include "org/minima/system/brains/ConsensusHandler.h"
#include "org/minima/system/brains/ConsensusPrint.h"
#include "org/minima/system/input/InputHandler.h"
#include "org/minima/system/network/MultiServer.h"
#include "org/minima/system/network/NetClient.h"
#include "org/minima/system/network/NetworkHandler.h"
#include "org/minima/system/network/rpc/RPCServer.h"
#include "org/minima/utils/Maths.h"
#include "org/minima/utils/MinimaLogger.h"
#include "org/minima/utils/json/JSONArray.h"
#include "org/minima/utils/json/JSONObject.h"
#include "org/minima/utils/messages/Message.h"

@interface OrgMinimaSystemBrainsConsensusPrint ()

- (OrgMinimaDatabaseMinimaDB *)getMainDB;

- (OrgMinimaSystemBrainsConsensusHandler *)getHandler;

- (OrgMinimaObjectsBaseMiniNumber *)getIfExistsWithJavaUtilHashtable:(JavaUtilHashtable *)zHashTable
                                    withOrgMinimaObjectsBaseMiniHash:(OrgMinimaObjectsBaseMiniHash *)zToken;

@end

__attribute__((unused)) static OrgMinimaDatabaseMinimaDB *OrgMinimaSystemBrainsConsensusPrint_getMainDB(OrgMinimaSystemBrainsConsensusPrint *self);

__attribute__((unused)) static OrgMinimaSystemBrainsConsensusHandler *OrgMinimaSystemBrainsConsensusPrint_getHandler(OrgMinimaSystemBrainsConsensusPrint *self);

__attribute__((unused)) static OrgMinimaObjectsBaseMiniNumber *OrgMinimaSystemBrainsConsensusPrint_getIfExistsWithJavaUtilHashtable_withOrgMinimaObjectsBaseMiniHash_(OrgMinimaSystemBrainsConsensusPrint *self, JavaUtilHashtable *zHashTable, OrgMinimaObjectsBaseMiniHash *zToken);

NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_PREFIX = @"CONSENSUSPRINT_";
NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_BALANCE = @"CONSENSUSPRINT_BALANCE";
NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_COINS = @"CONSENSUSPRINT_COINS";
NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_TXPOW = @"CONSENSUSPRINT_TXPOW";
NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_KEYS = @"CONSENSUSPRINT_KEYS";
NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_HISTORY = @"CONSENSUSPRINT_HISTORY";
NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_STATUS = @"CONSENSUSPRINT_STATUS";
NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_PRINTCHAIN = @"CONSENSUSPRINT_PRINTCHAIN";
NSString *OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_PRINTCHAIN_TREE = @"CONSENSUSPRINT_PRINTCHAIN_TREE";

@implementation OrgMinimaSystemBrainsConsensusPrint

- (instancetype)initWithOrgMinimaDatabaseMinimaDB:(OrgMinimaDatabaseMinimaDB *)zDB
        withOrgMinimaSystemBrainsConsensusHandler:(OrgMinimaSystemBrainsConsensusHandler *)zHandler {
  OrgMinimaSystemBrainsConsensusPrint_initWithOrgMinimaDatabaseMinimaDB_withOrgMinimaSystemBrainsConsensusHandler_(self, zDB, zHandler);
  return self;
}

- (OrgMinimaDatabaseMinimaDB *)getMainDB {
  return OrgMinimaSystemBrainsConsensusPrint_getMainDB(self);
}

- (OrgMinimaSystemBrainsConsensusHandler *)getHandler {
  return OrgMinimaSystemBrainsConsensusPrint_getHandler(self);
}

- (void)processMessageWithOrgMinimaUtilsMessagesMessage:(OrgMinimaUtilsMessagesMessage *)zMessage {
  if ([((OrgMinimaUtilsMessagesMessage *) nil_chk(zMessage)) isMessageTypeWithNSString:OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_PRINTCHAIN]) {
    OrgMinimaDatabaseTxpowtreeBlockTreePrinter *treeprint = create_OrgMinimaDatabaseTxpowtreeBlockTreePrinter_initWithOrgMinimaDatabaseTxpowtreeBlockTree_withBoolean_([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree], false);
    [treeprint printtree];
    OrgMinimaDatabaseTxpowdbTxPowDBPrinter_PrintDBWithOrgMinimaDatabaseTxpowdbTxPowDB_([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getTxPowDB]);
    OrgMinimaDatabaseCoindbCoinDBPrinter_PrintWithOrgMinimaDatabaseCoindbCoinDB_([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getCoinDB]);
    if ([((OrgMinimaDatabaseTxpowtreeBlockTree *) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree])) getChainRoot] == nil) {
      OrgMinimaUtilsMinimaLogger_logWithNSString_(@"NO BLOCKS!");
      return;
    }
    OrgMinimaUtilsMinimaLogger_logWithNSString_(@"---");
    OrgMinimaUtilsMinimaLogger_logWithNSString_(@"MMR");
    OrgMinimaUtilsMinimaLogger_logWithNSString_(@"---");
    OrgMinimaDatabaseMmrMMRSet *set = [((OrgMinimaDatabaseTxpowtreeBlockTreeNode *) nil_chk([((OrgMinimaDatabaseTxpowtreeBlockTree *) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree])) getChainTip])) getMMRSet];
    OrgMinimaDatabaseMmrMMRPrint_PrintWithOrgMinimaDatabaseMmrMMRSet_(set);
  }
  else if ([zMessage isMessageTypeWithNSString:OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_PRINTCHAIN_TREE]) {
    OrgMinimaDatabaseTxpowtreeBlockTreePrinter *treeprint = create_OrgMinimaDatabaseTxpowtreeBlockTreePrinter_initWithOrgMinimaDatabaseTxpowtreeBlockTree_withBoolean_([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree], true);
    [treeprint printtree];
  }
  else if ([zMessage isMessageTypeWithNSString:OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_BALANCE]) {
    OrgMinimaObjectsBaseMiniNumber *top = [((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getTopBlock];
    JavaUtilHashtable *full_details = create_JavaUtilHashtable_init();
    OrgMinimaUtilsJsonJSONObject *basejobj = create_OrgMinimaUtilsJsonJSONObject_init();
    [basejobj putWithId:@"tokenid" withId:[((OrgMinimaObjectsBaseMiniHash *) nil_chk(JreLoadStatic(OrgMinimaObjectsCoin, MINIMA_TOKENID))) to0xString]];
    [basejobj putWithId:@"token" withId:@"Minima"];
    [basejobj putWithId:@"total" withId:@"1000000000"];
    [basejobj putWithId:@"confirmed" withId:JreLoadStatic(OrgMinimaObjectsBaseMiniNumber, ZERO)];
    [basejobj putWithId:@"unconfirmed" withId:JreLoadStatic(OrgMinimaObjectsBaseMiniNumber, ZERO)];
    [full_details putWithId:[JreLoadStatic(OrgMinimaObjectsCoin, MINIMA_TOKENID) to0xString] withId:basejobj];
    JavaUtilHashtable *totals_confirmed = create_JavaUtilHashtable_init();
    JavaUtilHashtable *totals_unconfirmed = create_JavaUtilHashtable_init();
    id<OrgMinimaDatabaseUserdbUserDB> userdb = [((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getUserDB];
    JavaUtilArrayList *coins = [((id<OrgMinimaDatabaseCoindbCoinDB>) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getCoinDB])) getComplete];
    for (id<OrgMinimaDatabaseCoindbCoinDBRow> __strong coin in nil_chk(coins)) {
      jboolean rel = [((id<OrgMinimaDatabaseUserdbUserDB>) nil_chk(userdb)) isAddressRelevantWithOrgMinimaObjectsBaseMiniHash:[((OrgMinimaObjectsCoin *) nil_chk([((id<OrgMinimaDatabaseCoindbCoinDBRow>) nil_chk(coin)) getCoin])) getAddress]];
      if ([coin isInBlock] && rel) {
        NSString *tokid = [((OrgMinimaObjectsBaseMiniHash *) nil_chk([((OrgMinimaObjectsCoin *) nil_chk([coin getCoin])) getTokenID])) to0xString];
        OrgMinimaObjectsBaseMiniHash *tokhash = create_OrgMinimaObjectsBaseMiniHash_initWithNSString_(tokid);
        OrgMinimaObjectsBaseMiniNumber *depth = [((OrgMinimaObjectsBaseMiniNumber *) nil_chk(top)) subWithOrgMinimaObjectsBaseMiniNumber:[coin getInBlockNumber]];
        OrgMinimaObjectsTokenDetails *td = [((id<OrgMinimaDatabaseUserdbUserDB>) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getUserDB])) getTokenDetailWithOrgMinimaObjectsBaseMiniHash:tokhash];
        OrgMinimaUtilsJsonJSONObject *jobj = nil;
        if ([full_details containsKeyWithId:tokid]) {
          jobj = [full_details getWithId:tokid];
        }
        else {
          jobj = create_OrgMinimaUtilsJsonJSONObject_init();
          [jobj putWithId:@"tokenid" withId:tokid];
          if ([((NSString *) nil_chk(tokid)) isEqual:[JreLoadStatic(OrgMinimaObjectsCoin, MINIMA_TOKENID) to0xString]]) {
            [jobj putWithId:@"token" withId:@"Minima"];
          }
          else {
            [jobj putWithId:@"token" withId:[((OrgMinimaObjectsBaseMiniString *) nil_chk([((OrgMinimaObjectsTokenDetails *) nil_chk(td)) getName])) description]];
          }
          [jobj putWithId:@"confirmed" withId:JreLoadStatic(OrgMinimaObjectsBaseMiniNumber, ZERO)];
          [jobj putWithId:@"unconfirmed" withId:JreLoadStatic(OrgMinimaObjectsBaseMiniNumber, ZERO)];
          [full_details putWithId:tokid withId:jobj];
        }
        if (![coin isSpent]) {
          if ([((OrgMinimaObjectsBaseMiniNumber *) nil_chk(depth)) isMoreEqualWithOrgMinimaObjectsBaseMiniNumber:JreLoadStatic(OrgMinimaGlobalParams, MINIMA_CONFIRM_DEPTH)]) {
            OrgMinimaObjectsBaseMiniNumber *curr = [totals_confirmed getWithId:tokid];
            if (curr == nil) {
              curr = JreLoadStatic(OrgMinimaObjectsBaseMiniNumber, ZERO);
            }
            curr = [((OrgMinimaObjectsBaseMiniNumber *) nil_chk(curr)) addWithOrgMinimaObjectsBaseMiniNumber:[((OrgMinimaObjectsCoin *) nil_chk([coin getCoin])) getAmount]];
            [totals_confirmed putWithId:tokid withId:curr];
            [((OrgMinimaUtilsJsonJSONObject *) nil_chk(jobj)) putWithId:@"confirmed" withId:curr];
          }
          else {
            OrgMinimaObjectsBaseMiniNumber *curr = [totals_unconfirmed getWithId:tokid];
            if (curr == nil) {
              curr = JreLoadStatic(OrgMinimaObjectsBaseMiniNumber, ZERO);
            }
            curr = [((OrgMinimaObjectsBaseMiniNumber *) nil_chk(curr)) addWithOrgMinimaObjectsBaseMiniNumber:[((OrgMinimaObjectsCoin *) nil_chk([coin getCoin])) getAmount]];
            [totals_unconfirmed putWithId:tokid withId:curr];
            [((OrgMinimaUtilsJsonJSONObject *) nil_chk(jobj)) putWithId:@"unconfirmed" withId:curr];
          }
        }
      }
    }
    OrgMinimaUtilsJsonJSONObject *allbal = OrgMinimaSystemInputInputHandler_getResponseJSONWithOrgMinimaUtilsMessagesMessage_(zMessage);
    OrgMinimaUtilsJsonJSONArray *totbal = create_OrgMinimaUtilsJsonJSONArray_init();
    id<JavaUtilEnumeration> fulls = [full_details keys];
    while ([((id<JavaUtilEnumeration>) nil_chk(fulls)) hasMoreElements]) {
      NSString *full = [fulls nextElement];
      OrgMinimaUtilsJsonJSONObject *jobj = [full_details getWithId:full];
      NSString *tokenid = (NSString *) cast_chk([((OrgMinimaUtilsJsonJSONObject *) nil_chk(jobj)) getWithId:@"tokenid"], [NSString class]);
      OrgMinimaObjectsBaseMiniHash *tok = create_OrgMinimaObjectsBaseMiniHash_initWithNSString_(tokenid);
      if ([tok isExactlyEqualWithOrgMinimaObjectsBaseMiniData:JreLoadStatic(OrgMinimaObjectsCoin, MINIMA_TOKENID)]) {
        OrgMinimaObjectsBaseMiniNumber *tot_conf = (OrgMinimaObjectsBaseMiniNumber *) cast_chk([jobj getWithId:@"confirmed"], [OrgMinimaObjectsBaseMiniNumber class]);
        OrgMinimaObjectsBaseMiniNumber *tot_unconf = (OrgMinimaObjectsBaseMiniNumber *) cast_chk([jobj getWithId:@"unconfirmed"], [OrgMinimaObjectsBaseMiniNumber class]);
        [jobj putWithId:@"confirmed" withId:[((OrgMinimaObjectsBaseMiniNumber *) nil_chk(tot_conf)) description]];
        [jobj putWithId:@"unconfirmed" withId:[((OrgMinimaObjectsBaseMiniNumber *) nil_chk(tot_unconf)) description]];
        [jobj putWithId:@"total" withId:@"1000000000"];
      }
      else {
        OrgMinimaObjectsTokenDetails *td = [((id<OrgMinimaDatabaseUserdbUserDB>) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getUserDB])) getTokenDetailWithOrgMinimaObjectsBaseMiniHash:tok];
        OrgMinimaObjectsBaseMiniNumber *tot_conf = (OrgMinimaObjectsBaseMiniNumber *) cast_chk([jobj getWithId:@"confirmed"], [OrgMinimaObjectsBaseMiniNumber class]);
        OrgMinimaObjectsBaseMiniNumber *tot_scconf = [((OrgMinimaObjectsBaseMiniNumber *) nil_chk(tot_conf)) multWithOrgMinimaObjectsBaseMiniNumber:[((OrgMinimaObjectsTokenDetails *) nil_chk(td)) getScaleFactor]];
        OrgMinimaObjectsBaseMiniNumber *tot_unconf = (OrgMinimaObjectsBaseMiniNumber *) cast_chk([jobj getWithId:@"unconfirmed"], [OrgMinimaObjectsBaseMiniNumber class]);
        OrgMinimaObjectsBaseMiniNumber *tot_scunconf = [((OrgMinimaObjectsBaseMiniNumber *) nil_chk(tot_unconf)) multWithOrgMinimaObjectsBaseMiniNumber:[td getScaleFactor]];
        OrgMinimaObjectsBaseMiniNumber *tot_toks = [((OrgMinimaObjectsBaseMiniNumber *) nil_chk([td getAmount])) multWithOrgMinimaObjectsBaseMiniNumber:[td getScaleFactor]];
        [jobj putWithId:@"confirmed" withId:[((OrgMinimaObjectsBaseMiniNumber *) nil_chk(tot_scconf)) description]];
        [jobj putWithId:@"unconfirmed" withId:[((OrgMinimaObjectsBaseMiniNumber *) nil_chk(tot_scunconf)) description]];
        [jobj putWithId:@"total" withId:[((OrgMinimaObjectsBaseMiniNumber *) nil_chk(tot_toks)) description]];
      }
      [totbal addWithId:jobj];
    }
    [((OrgMinimaUtilsJsonJSONObject *) nil_chk(allbal)) putWithId:@"balance" withId:totbal];
    OrgMinimaSystemInputInputHandler_endResponseWithOrgMinimaUtilsMessagesMessage_withBoolean_withNSString_(zMessage, true, @"");
  }
  else if ([zMessage isMessageTypeWithNSString:OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_COINS]) {
    NSString *address = @"";
    if ([zMessage existsWithNSString:@"address"]) {
      address = [zMessage getStringWithNSString:@"address"];
    }
    OrgMinimaDatabaseTxpowtreeBlockTreeNode *tip = [((OrgMinimaDatabaseTxpowtreeBlockTree *) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree])) getChainTip];
    OrgMinimaDatabaseMmrMMRSet *baseset = [((OrgMinimaDatabaseTxpowtreeBlockTreeNode *) nil_chk(tip)) getMMRSet];
    OrgMinimaUtilsJsonJSONObject *allcoins = OrgMinimaSystemInputInputHandler_getResponseJSONWithOrgMinimaUtilsMessagesMessage_(zMessage);
    OrgMinimaUtilsJsonJSONArray *totcoins = create_OrgMinimaUtilsJsonJSONArray_init();
    JavaUtilArrayList *coins = [((id<OrgMinimaDatabaseCoindbCoinDB>) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getCoinDB])) getComplete];
    for (id<OrgMinimaDatabaseCoindbCoinDBRow> __strong coin in nil_chk(coins)) {
      if (![((id<OrgMinimaDatabaseCoindbCoinDBRow>) nil_chk(coin)) isSpent]) {
        if ([((NSString *) nil_chk(address)) isEqual:@""]) {
          [totcoins addWithId:[((OrgMinimaDatabaseMmrMMRProof *) nil_chk([((OrgMinimaDatabaseMmrMMRSet *) nil_chk(baseset)) getProofWithOrgMinimaObjectsBaseMiniNumber:[coin getMMREntry]])) toJSON]];
        }
        else if ([address isEqual:[((OrgMinimaObjectsBaseMiniHash *) nil_chk([((OrgMinimaObjectsCoin *) nil_chk([coin getCoin])) getAddress])) to0xString]]) {
          [totcoins addWithId:[((OrgMinimaDatabaseMmrMMRProof *) nil_chk([((OrgMinimaDatabaseMmrMMRSet *) nil_chk(baseset)) getProofWithOrgMinimaObjectsBaseMiniNumber:[coin getMMREntry]])) toJSON]];
        }
      }
    }
    [((OrgMinimaUtilsJsonJSONObject *) nil_chk(allcoins)) putWithId:@"coins" withId:totcoins];
    OrgMinimaSystemInputInputHandler_endResponseWithOrgMinimaUtilsMessagesMessage_withBoolean_withNSString_(zMessage, true, @"");
  }
  else if ([zMessage isMessageTypeWithNSString:OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_HISTORY]) {
    if ([zMessage existsWithNSString:@"clear"]) {
      [((id<OrgMinimaDatabaseUserdbUserDB>) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getUserDB])) clearHistory];
    }
    JavaUtilArrayList *history = [((id<OrgMinimaDatabaseUserdbUserDB>) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getUserDB])) getHistory];
    OrgMinimaUtilsJsonJSONObject *allbal = OrgMinimaSystemInputInputHandler_getResponseJSONWithOrgMinimaUtilsMessagesMessage_(zMessage);
    OrgMinimaUtilsJsonJSONArray *totbal = create_OrgMinimaUtilsJsonJSONArray_init();
    for (OrgMinimaDatabaseUserdbJavareltxpow * __strong rpow in nil_chk(history)) {
      [totbal addWithId:[((OrgMinimaDatabaseUserdbJavareltxpow *) nil_chk(rpow)) toJSON]];
    }
    [((OrgMinimaUtilsJsonJSONObject *) nil_chk(allbal)) putWithId:@"history" withId:totbal];
    OrgMinimaSystemInputInputHandler_endResponseWithOrgMinimaUtilsMessagesMessage_withBoolean_withNSString_(zMessage, true, @"");
  }
  else if ([zMessage isMessageTypeWithNSString:OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_TXPOW]) {
    NSString *txpow = [zMessage getStringWithNSString:@"txpow"];
    OrgMinimaObjectsBaseMiniHash *txp = create_OrgMinimaObjectsBaseMiniHash_initWithNSString_(txpow);
    OrgMinimaObjectsTxPOW *pow = [((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getTxPOWWithOrgMinimaObjectsBaseMiniHash:txp];
    if (pow == nil) {
      OrgMinimaSystemInputInputHandler_endResponseWithOrgMinimaUtilsMessagesMessage_withBoolean_withNSString_(zMessage, false, JreStrcat("$$", @"No TxPOW found for ", txpow));
    }
    else {
      [((OrgMinimaUtilsJsonJSONObject *) nil_chk(OrgMinimaSystemInputInputHandler_getResponseJSONWithOrgMinimaUtilsMessagesMessage_(zMessage))) putWithId:@"txpow" withId:[pow toJSON]];
      OrgMinimaSystemInputInputHandler_endResponseWithOrgMinimaUtilsMessagesMessage_withBoolean_withNSString_(zMessage, true, @"");
    }
  }
  else if ([zMessage isMessageTypeWithNSString:OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_KEYS]) {
    JavaUtilArrayList *keys = [((id<OrgMinimaDatabaseUserdbUserDB>) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getUserDB])) getKeys];
    OrgMinimaUtilsJsonJSONArray *arrpub = create_OrgMinimaUtilsJsonJSONArray_init();
    for (OrgMinimaObjectsPubPrivKey * __strong key in nil_chk(keys)) {
      [arrpub addWithId:[((OrgMinimaObjectsPubPrivKey *) nil_chk(key)) description]];
    }
    [((OrgMinimaUtilsJsonJSONObject *) nil_chk(OrgMinimaSystemInputInputHandler_getResponseJSONWithOrgMinimaUtilsMessagesMessage_(zMessage))) putWithId:@"publickeys" withId:arrpub];
    JavaUtilArrayList *addresses = [((id<OrgMinimaDatabaseUserdbUserDB>) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getUserDB])) getAllAddresses];
    OrgMinimaUtilsJsonJSONArray *arraddr = create_OrgMinimaUtilsJsonJSONArray_init();
    for (OrgMinimaObjectsAddress * __strong addr in nil_chk(addresses)) {
      [arraddr addWithId:[((OrgMinimaObjectsAddress *) nil_chk(addr)) toJSON]];
    }
    [((OrgMinimaUtilsJsonJSONObject *) nil_chk(OrgMinimaSystemInputInputHandler_getResponseJSONWithOrgMinimaUtilsMessagesMessage_(zMessage))) putWithId:@"addresses" withId:arraddr];
    OrgMinimaSystemInputInputHandler_endResponseWithOrgMinimaUtilsMessagesMessage_withBoolean_withNSString_(zMessage, true, @"");
  }
  else if ([zMessage isMessageTypeWithNSString:OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_STATUS]) {
    OrgMinimaSystemMain *main = [((OrgMinimaSystemBrainsConsensusHandler *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getHandler(self))) getMainHandler];
    if ([((OrgMinimaDatabaseTxpowtreeBlockTree *) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree])) getChainRoot] == nil) {
      OrgMinimaSystemInputInputHandler_endResponseWithOrgMinimaUtilsMessagesMessage_withBoolean_withNSString_(zMessage, false, @"No blocks!");
      return;
    }
    OrgMinimaDatabaseTxpowtreeBlockTreeNode *tip = [((OrgMinimaDatabaseTxpowtreeBlockTree *) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree])) getChainTip];
    OrgMinimaDatabaseTxpowtreeBlockTreeNode *root = [((OrgMinimaDatabaseTxpowtreeBlockTree *) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree])) getChainRoot];
    OrgMinimaObjectsBaseMiniNumber *lastblock = [((OrgMinimaObjectsTxPOW *) nil_chk([((OrgMinimaDatabaseTxpowtreeBlockTreeNode *) nil_chk(tip)) getTxPow])) getBlockNumber];
    OrgMinimaUtilsJsonJSONObject *status = OrgMinimaSystemInputInputHandler_getResponseJSONWithOrgMinimaUtilsMessagesMessage_(zMessage);
    [((OrgMinimaUtilsJsonJSONObject *) nil_chk(status)) putWithId:@"version" withId:JavaLangDouble_valueOfWithDouble_(0.4)];
    jlong timediff = JavaLangSystem_currentTimeMillis() - [((OrgMinimaSystemMain *) nil_chk([((OrgMinimaSystemBrainsConsensusHandler *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getHandler(self))) getMainHandler])) getNodeStartTime];
    NSString *uptime = OrgMinimaUtilsMaths_ConvertMilliToTimeWithLong_(timediff);
    [status putWithId:@"milliuptime" withId:JavaLangLong_valueOfWithLong_(timediff)];
    [status putWithId:@"stringuptime" withId:uptime];
    [status putWithId:@"conf" withId:[((OrgMinimaSystemBackupBackupManager *) nil_chk([((OrgMinimaSystemMain *) nil_chk(main)) getBackupManager])) getRootFolder]];
    [status putWithId:@"host" withId:[((OrgMinimaSystemNetworkRpcRPCServer *) nil_chk([((OrgMinimaSystemNetworkNetworkHandler *) nil_chk([main getNetworkHandler])) getRPCServer])) getHost]];
    [status putWithId:@"port" withId:JavaLangInteger_valueOfWithInt_([((OrgMinimaSystemNetworkMultiServer *) nil_chk([((OrgMinimaSystemNetworkNetworkHandler *) nil_chk([main getNetworkHandler])) getServer])) getPort])];
    [status putWithId:@"rpcport" withId:JavaLangInteger_valueOfWithInt_([((OrgMinimaSystemNetworkRpcRPCServer *) nil_chk([((OrgMinimaSystemNetworkNetworkHandler *) nil_chk([main getNetworkHandler])) getRPCServer])) getPort])];
    [status putWithId:@"root" withId:[((OrgMinimaObjectsTxPOW *) nil_chk([((OrgMinimaDatabaseTxpowtreeBlockTreeNode *) nil_chk(root)) getTxPow])) toJSON]];
    [status putWithId:@"tip" withId:[((OrgMinimaObjectsTxPOW *) nil_chk([tip getTxPow])) toJSON]];
    [status putWithId:@"chainspeed" withId:JavaLangDouble_valueOfWithDouble_([((OrgMinimaDatabaseTxpowtreeBlockTree *) nil_chk([((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getMainTree])) getChainSpeed])];
    [status putWithId:@"lastblock" withId:[((OrgMinimaObjectsBaseMiniNumber *) nil_chk(lastblock)) description]];
    [status putWithId:@"totalpow" withId:[((JavaMathBigInteger *) nil_chk([root getTotalWeight])) description]];
    [status putWithId:@"IBD " withId:JavaLangInteger_valueOfWithInt_(+[((OrgMinimaDatabaseMinimaDB *) nil_chk(OrgMinimaSystemBrainsConsensusPrint_getMainDB(self))) getIntroSyncSize])];
    JavaUtilArrayList *nets = [((OrgMinimaSystemNetworkNetworkHandler *) nil_chk([main getNetworkHandler])) getNetClients];
    OrgMinimaUtilsJsonJSONArray *netarr = create_OrgMinimaUtilsJsonJSONArray_init();
    if ([((JavaUtilArrayList *) nil_chk(nets)) size] > 0) {
      for (OrgMinimaSystemNetworkNetClient * __strong net in nets) {
        [netarr addWithId:[((OrgMinimaSystemNetworkNetClient *) nil_chk(net)) toJSON]];
      }
    }
    [status putWithId:@"network" withId:netarr];
    OrgMinimaSystemInputInputHandler_endResponseWithOrgMinimaUtilsMessagesMessage_withBoolean_withNSString_(zMessage, true, @"");
    {
      return;
    }
  }
}

- (OrgMinimaObjectsBaseMiniNumber *)getIfExistsWithJavaUtilHashtable:(JavaUtilHashtable *)zHashTable
                                    withOrgMinimaObjectsBaseMiniHash:(OrgMinimaObjectsBaseMiniHash *)zToken {
  return OrgMinimaSystemBrainsConsensusPrint_getIfExistsWithJavaUtilHashtable_withOrgMinimaObjectsBaseMiniHash_(self, zHashTable, zToken);
}

- (void)dealloc {
  RELEASE_(mDB_);
  RELEASE_(mHandler_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "LOrgMinimaDatabaseMinimaDB;", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgMinimaSystemBrainsConsensusHandler;", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 1, 2, 3, -1, -1, -1 },
    { NULL, "LOrgMinimaObjectsBaseMiniNumber;", 0x2, 4, 5, -1, 6, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgMinimaDatabaseMinimaDB:withOrgMinimaSystemBrainsConsensusHandler:);
  methods[1].selector = @selector(getMainDB);
  methods[2].selector = @selector(getHandler);
  methods[3].selector = @selector(processMessageWithOrgMinimaUtilsMessagesMessage:);
  methods[4].selector = @selector(getIfExistsWithJavaUtilHashtable:withOrgMinimaObjectsBaseMiniHash:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "CONSENSUS_PREFIX", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 7, -1, -1 },
    { "CONSENSUS_BALANCE", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 8, -1, -1 },
    { "CONSENSUS_COINS", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 9, -1, -1 },
    { "CONSENSUS_TXPOW", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 10, -1, -1 },
    { "CONSENSUS_KEYS", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 11, -1, -1 },
    { "CONSENSUS_HISTORY", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 12, -1, -1 },
    { "CONSENSUS_STATUS", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 13, -1, -1 },
    { "CONSENSUS_PRINTCHAIN", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 14, -1, -1 },
    { "CONSENSUS_PRINTCHAIN_TREE", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 15, -1, -1 },
    { "mDB_", "LOrgMinimaDatabaseMinimaDB;", .constantValue.asLong = 0, 0x0, -1, -1, -1, -1 },
    { "mHandler_", "LOrgMinimaSystemBrainsConsensusHandler;", .constantValue.asLong = 0, 0x0, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgMinimaDatabaseMinimaDB;LOrgMinimaSystemBrainsConsensusHandler;", "processMessage", "LOrgMinimaUtilsMessagesMessage;", "LJavaLangException;", "getIfExists", "LJavaUtilHashtable;LOrgMinimaObjectsBaseMiniHash;", "(Ljava/util/Hashtable<Lorg/minima/objects/base/MiniHash;Lorg/minima/objects/base/MiniNumber;>;Lorg/minima/objects/base/MiniHash;)Lorg/minima/objects/base/MiniNumber;", &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_PREFIX, &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_BALANCE, &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_COINS, &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_TXPOW, &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_KEYS, &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_HISTORY, &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_STATUS, &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_PRINTCHAIN, &OrgMinimaSystemBrainsConsensusPrint_CONSENSUS_PRINTCHAIN_TREE };
  static const J2ObjcClassInfo _OrgMinimaSystemBrainsConsensusPrint = { "ConsensusPrint", "org.minima.system.brains", ptrTable, methods, fields, 7, 0x1, 5, 11, -1, -1, -1, -1, -1 };
  return &_OrgMinimaSystemBrainsConsensusPrint;
}

@end

void OrgMinimaSystemBrainsConsensusPrint_initWithOrgMinimaDatabaseMinimaDB_withOrgMinimaSystemBrainsConsensusHandler_(OrgMinimaSystemBrainsConsensusPrint *self, OrgMinimaDatabaseMinimaDB *zDB, OrgMinimaSystemBrainsConsensusHandler *zHandler) {
  NSObject_init(self);
  JreStrongAssign(&self->mDB_, zDB);
  JreStrongAssign(&self->mHandler_, zHandler);
}

OrgMinimaSystemBrainsConsensusPrint *new_OrgMinimaSystemBrainsConsensusPrint_initWithOrgMinimaDatabaseMinimaDB_withOrgMinimaSystemBrainsConsensusHandler_(OrgMinimaDatabaseMinimaDB *zDB, OrgMinimaSystemBrainsConsensusHandler *zHandler) {
  J2OBJC_NEW_IMPL(OrgMinimaSystemBrainsConsensusPrint, initWithOrgMinimaDatabaseMinimaDB_withOrgMinimaSystemBrainsConsensusHandler_, zDB, zHandler)
}

OrgMinimaSystemBrainsConsensusPrint *create_OrgMinimaSystemBrainsConsensusPrint_initWithOrgMinimaDatabaseMinimaDB_withOrgMinimaSystemBrainsConsensusHandler_(OrgMinimaDatabaseMinimaDB *zDB, OrgMinimaSystemBrainsConsensusHandler *zHandler) {
  J2OBJC_CREATE_IMPL(OrgMinimaSystemBrainsConsensusPrint, initWithOrgMinimaDatabaseMinimaDB_withOrgMinimaSystemBrainsConsensusHandler_, zDB, zHandler)
}

OrgMinimaDatabaseMinimaDB *OrgMinimaSystemBrainsConsensusPrint_getMainDB(OrgMinimaSystemBrainsConsensusPrint *self) {
  return self->mDB_;
}

OrgMinimaSystemBrainsConsensusHandler *OrgMinimaSystemBrainsConsensusPrint_getHandler(OrgMinimaSystemBrainsConsensusPrint *self) {
  return self->mHandler_;
}

OrgMinimaObjectsBaseMiniNumber *OrgMinimaSystemBrainsConsensusPrint_getIfExistsWithJavaUtilHashtable_withOrgMinimaObjectsBaseMiniHash_(OrgMinimaSystemBrainsConsensusPrint *self, JavaUtilHashtable *zHashTable, OrgMinimaObjectsBaseMiniHash *zToken) {
  id<JavaUtilEnumeration> keys = [((JavaUtilHashtable *) nil_chk(zHashTable)) keys];
  while ([((id<JavaUtilEnumeration>) nil_chk(keys)) hasMoreElements]) {
    OrgMinimaObjectsBaseMiniHash *key = [keys nextElement];
    if ([((OrgMinimaObjectsBaseMiniHash *) nil_chk(key)) isExactlyEqualWithOrgMinimaObjectsBaseMiniData:zToken]) {
      return [zHashTable getWithId:key];
    }
  }
  return nil;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgMinimaSystemBrainsConsensusPrint)
