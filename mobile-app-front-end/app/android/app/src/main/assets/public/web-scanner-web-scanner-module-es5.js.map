{"version":3,"sources":["./src/app/web-scanner/web-scanner.page.html","./src/app/web-scanner/web-scanner.module.ts","./src/app/web-scanner/web-scanner.page.scss","./src/app/web-scanner/web-scanner.page.ts"],"names":[],"mappings":"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","file":"web-scanner-web-scanner-module-es5.js","sourcesContent":["module.exports = \"<ion-app>\\n<ion-header>\\n  <ion-toolbar>\\n    <ion-menu-button slot=\\\"start\\\"></ion-menu-button>\\n    <ion-title color=\\\"primary\\\">Web</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n\\n\\n<ion-content *ngIf=\\\"isCameraOpen==false\\\">\\n\\n    <ion-list lines=\\\"none\\\">\\n      <ion-item lines=\\\"none\\\" class=\\\"web-img\\\">\\n        <ion-img class=\\\"web-img\\\" [src]=\\\"identifyImg()\\\"></ion-img>\\n      </ion-item>\\n      <ion-item lines=\\\"none\\\">\\n        <ion-text class=\\\"web-lbl\\\" style=\\\"font-family: Aeonik-light; width:100%; text-align: center;\\\">Minima Web ready to scan.</ion-text>\\n      </ion-item>\\n      \\n      <ion-item>\\n        <ion-text class=\\\"web-lbl\\\" style=\\\"font-family: Aeonik-light; width:100%; text-align: center;\\\">Navigate to <ion-note style=\\\"font-weight: bold;\\\">\\\"https://dev.minima.global\\\"</ion-note> on desktop.</ion-text>\\n      </ion-item>\\n    </ion-list>\\n    \\n</ion-content>\\n\\n\\n\\n<ion-footer>\\n  <ion-toolbar>\\n    <ion-buttons>\\n      <ion-button class=\\\"qr-button\\\" expand=\\\"block\\\" (click)=\\\"stopCamera()\\\"  *ngIf=\\\"isCameraOpen===true\\\">\\n        Stop scanning\\n       </ion-button> \\n\\n      <ion-button class=\\\"qr-button\\\" (click)=\\\"scanQR()\\\" *ngIf=\\\"isCameraOpen===false\\\">\\n        <ion-icon name=\\\"qr-scanner\\\"></ion-icon> \\n        Scan Qr Code\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-footer>\\n</ion-app>\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { WebScannerPage } from './web-scanner.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: WebScannerPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [WebScannerPage]\n})\nexport class WebScannerPageModule {}\n","module.exports = \".qr-button {\\n  width: 100%;\\n  height: 40px;\\n}\\n\\n.qr-button:hover {\\n  height: 50px;\\n}\\n\\nion-icon {\\n  padding: 5px;\\n}\\n\\n.web-img {\\n  padding-top: 20px;\\n  margin: auto;\\n  width: 300px;\\n  -webkit-box-align: center;\\n          align-items: center;\\n}\\n\\n.web-lbl {\\n  white-space: normal;\\n  margin: auto;\\n  -webkit-box-align: center;\\n          align-items: center;\\n  font-family: \\\"Aeonik-light\\\";\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9lbGlhcy9Qcm9qZWN0cy9taW5pbWFjb3JlL21vYmlsZS1hcHAtZnJvbnQtZW5kL2FwcC9zcmMvYXBwL3dlYi1zY2FubmVyL3dlYi1zY2FubmVyLnBhZ2Uuc2NzcyIsInNyYy9hcHAvd2ViLXNjYW5uZXIvd2ViLXNjYW5uZXIucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksV0FBQTtFQUNBLFlBQUE7QUNDSjs7QURDQTtFQUNJLFlBQUE7QUNFSjs7QURBQTtFQUNJLFlBQUE7QUNHSjs7QUREQTtFQUNJLGlCQUFBO0VBQ0EsWUFBQTtFQUNBLFlBQUE7RUFDQSx5QkFBQTtVQUFBLG1CQUFBO0FDSUo7O0FERkE7RUFDSSxtQkFBQTtFQUNBLFlBQUE7RUFDQSx5QkFBQTtVQUFBLG1CQUFBO0VBQ0EsMkJBQUE7QUNLSiIsImZpbGUiOiJzcmMvYXBwL3dlYi1zY2FubmVyL3dlYi1zY2FubmVyLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5xci1idXR0b24ge1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogNDBweDtcbn1cbi5xci1idXR0b246aG92ZXIge1xuICAgIGhlaWdodDogNTBweDtcbn1cbmlvbi1pY29uIHtcbiAgICBwYWRkaW5nOiA1cHg7XG59XG4ud2ViLWltZyB7XG4gICAgcGFkZGluZy10b3A6IDIwcHg7XG4gICAgbWFyZ2luOiBhdXRvO1xuICAgIHdpZHRoOiAzMDBweDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xufVxuLndlYi1sYmwge1xuICAgIHdoaXRlLXNwYWNlOiBub3JtYWw7XG4gICAgbWFyZ2luOiBhdXRvO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgZm9udC1mYW1pbHk6ICdBZW9uaWstbGlnaHQnO1xuXG59XG5cblxuLy8gaU9TICYgQW5kcm9pZCBsYXlvdXQgZml4XG4vLyAuaW9zIHdlYi1pbWcge1xuLy8gICAgIHBhZGRpbmctdG9wOiAyMHB4O1xuLy8gfVxuLy8gLm1kIHdlYi1pbWcge1xuLy8gICAgIHBhZGRpbmctdG9wOiAyMHB4O1xuLy8gfVxuIiwiLnFyLWJ1dHRvbiB7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDQwcHg7XG59XG5cbi5xci1idXR0b246aG92ZXIge1xuICBoZWlnaHQ6IDUwcHg7XG59XG5cbmlvbi1pY29uIHtcbiAgcGFkZGluZzogNXB4O1xufVxuXG4ud2ViLWltZyB7XG4gIHBhZGRpbmctdG9wOiAyMHB4O1xuICBtYXJnaW46IGF1dG87XG4gIHdpZHRoOiAzMDBweDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbn1cblxuLndlYi1sYmwge1xuICB3aGl0ZS1zcGFjZTogbm9ybWFsO1xuICBtYXJnaW46IGF1dG87XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGZvbnQtZmFtaWx5OiBcIkFlb25pay1saWdodFwiO1xufSJdfQ== */\"","import { MinimaApiService } from './../service/minima-api.service';\nimport { AlertController } from '@ionic/angular';\nimport { QRScanner, QRScannerStatus } from '@ionic-native/qr-scanner/ngx';\nimport { Component, OnInit, NgZone } from '@angular/core';\n\n@Component({\n  selector: 'app-web-scanner',\n  templateUrl: './web-scanner.page.html',\n  styleUrls: ['./web-scanner.page.scss'],\n})\nexport class WebScannerPage implements OnInit {\n\n  isCameraOpen: boolean = false;\n  private scanSub: any = null;\n  public data: any = {};\n  public getUUID: any;\n  ionApp = <HTMLElement>document.getElementsByTagName('ion-app')[0]; \n\n  constructor(private qrScanner: QRScanner,\n     private zone: NgZone,\n     public alertController: AlertController,\n     private api: MinimaApiService) {}\n\n  ngOnInit() {\n  }\n  \n  ionViewWillEnter(){\n   this.isCameraOpen = false;\n  }\n\n  ionViewWillLeave(){\n   this.stopCamera();\n  }\n\n  // figure out which web pic to use depending if light or dark mode\n  identifyImg() {\n    if(document.body.classList.value === 'dark') {\n      return '../assets/darkweb.svg';\n    } else {\n      return '../assets/lightweb.svg';\n    }\n  }\n\n  scanQR() {\n    this.qrScanner.prepare()\n      .then((status: QRScannerStatus) => {\n        if (status.authorized) {\n          // camera permission was granted\n          console.log('scanQR', status);\n          setTimeout(() => {\n            window.document.querySelectorAll('ion-content')\n                  .forEach(element => {\n                      const element1 = element.shadowRoot.querySelector('style');\n                      element1.innerHTML = element1.innerHTML\n                                                   .replace('--background:var(--ion-background-color,#fff);', '--background: transparent');\n                  });\n        }, 300);\n\n        this.qrScanner.show();\n        this.isCameraOpen = true;\n\n        this.scanSub = this.qrScanner.scan().subscribe((text: string) => {\n          console.log('Scanned something', text);\n          this.zone.run(()=>{\n            //alert(\"Scanned this ->>>\" + text);\n          \n            this.stopCamera();\n            this.qrWebLink(text);\n            // window.document.querySelector('ion-content').classList.remove('.transparentBody');\n           \n            window.document.querySelectorAll('ion-content')\n                  .forEach(element => {\n                      const element1 = element.shadowRoot.querySelector('style');\n                      element1.innerHTML = element1.innerHTML\n                  .replace('--background: transparent', '--background:var(--ion-background-color,#fff);');\n            });\n            this.isCameraOpen = false;\n            })\n        }, (err) => {\n          console.log('Scanned failed', err);\n        })\n\n      } else if (status.denied) {\n        // camera permission was permanently denied\n        // you must use QRScanner.openSettings() method to guide the user to the settings page\n        // then they can grant the permission from there\n        console.log('error permission needed');\n        this.presentAlert('Please check camera permission','Error');\n      } else {\n        // permission was denied, but not permanently. You can ask for permission again at a later time.\n        console.log('error permission needed');\n        this.presentAlert('Please check camera permission','Error');\n      }\n    })\n    .catch((e: any) => console.log('Error is', e));\n  }\n\n  qrWebLink(text : any) {\n    this.data.url = text;\n    if(this.data.url!==''){\n    this.api.webLink(this.data).then((res : any) => {\n      console.log(\"weblink \" + JSON.stringify(res));\n        if(res.status === true){\n          this.presentAlert('Success!', 'You are now connected.');\n        } else {\n          alert(\"Hasn't connected\");\n          this.presentAlert(res.error, 'Error');\n        }\n      });\n    } else {\n      this.presentAlert('Please rescan qr image.', 'Unsucessful!');\n    }\n  }\n\n  stopCamera() {\n    console.log('stop camera', this.scanSub);\n    if(this.scanSub!==null){\n      console.log(\"stopCamera - is not null..\")\n      this.qrScanner.hide();\n      this.scanSub.unsubscribe();\n    }\n    window.document.querySelectorAll('ion-content')\n                  .forEach(element => {\n                      const element1 = element.shadowRoot.querySelector('style');\n                      element1.innerHTML = element1.innerHTML\n                  .replace('--background: transparent', '--background:var(--ion-background-color,#fff);');\n            });\n            this.isCameraOpen = false;\n            \n    this.qrScanner.destroy();\n  }\n\n  async presentAlert(msg:string,header:string) {\n    const alert = await this.alertController.create({\n      header: header,\n      message: msg,\n      buttons: ['OK']\n    });\n\n    await alert.present();\n  }\n\n}\n"],"sourceRoot":""}